# üìú –ü—Ä–∞–≤–∏–ª–∞ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã (Trivia Rules)

> **–ò—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã:** –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã, –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ –∏–∑ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ backend (`trivia-api`). –ü—Ä–∏ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –ª–æ–≥–∏–∫–∏ –≤ –∫–æ–¥–µ —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è.

---

## 1. –ò–≥—Ä–æ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å

### –ü–æ—Ç–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤
- –í–æ–ø—Ä–æ—Å—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –≤—Å–µ–º –∞–∫—Ç–∏–≤–Ω—ã–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —á–µ—Ä–µ–∑ WebSocket.
- –ö–∞–∂–¥—ã–π –≤–æ–ø—Ä–æ—Å –∏–º–µ–µ—Ç —Å–≤–æ–π –ª–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏ (`TimeLimitSec`), –æ–±—ã—á–Ω–æ 10-15 —Å–µ–∫—É–Ω–¥.
- –£—á–∞—Å—Ç–Ω–∏–∫ –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç **–¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–∞–π–º–µ—Ä–∞**.

### –í—ã–±—ã–≤–∞–Ω–∏–µ (Elimination)
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **–≤—ã–±—ã–≤–∞–µ—Ç** –∏–∑ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã (—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–µ–º), –µ—Å–ª–∏:
1. –û—Ç–≤–µ—Ç–∏–ª **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ** –Ω–∞ –≤–æ–ø—Ä–æ—Å.
2. –ù–µ –ø—Ä–∏—Å–ª–∞–ª –æ—Ç–≤–µ—Ç –≤–æ–≤—Å–µ (—Ç–∞–π–º–∞—É—Ç).
3. –ü—Ä–∏—Å–ª–∞–ª –æ—Ç–≤–µ—Ç **–ø–æ–∑–∂–µ** –æ—Ç–≤–µ–¥—ë–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (—Å —É—á–µ—Ç–æ–º –Ω–µ–±–æ–ª—å—à–æ–π —Å–µ—Ç–µ–≤–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏).

> **–í–∞–∂–Ω–æ:** –í—ã–±—ã–≤—à–∏–π —É—á–∞—Å—Ç–Ω–∏–∫ –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–ø—Ä–æ—Å—ã, –Ω–æ –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –∏ –ø—Ä–µ—Ç–µ–Ω–¥–æ–≤–∞—Ç—å –Ω–∞ –ø–æ–±–µ–¥—É.

---

## 2. –°–∏—Å—Ç–µ–º–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –æ—á–∫–æ–≤

### –û—á–∫–∏ –∑–∞ –æ—Ç–≤–µ—Ç
–õ–æ–≥–∏–∫–∞ –ø–æ–¥—Å—á–µ—Ç–∞ –æ—á–∫–æ–≤ **—É–ø—Ä–æ—â–µ–Ω–∞** –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ (v1.0):
- **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:** +1 –±–∞–ª–ª.
- **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:** 0 –±–∞–ª–ª–æ–≤.
- **–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞:** –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –æ—á–∫–∏ (—Ö–æ—Ç—è –ø–∞—Ä–∞–º–µ—Ç—Ä `responseTimeMs` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è).
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–æ–ø—Ä–æ—Å–∞:** –ü–æ–ª–µ `PointValue` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ **–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è** –ø—Ä–∏ –ø–æ–¥—Å—á–µ—Ç–µ. –í—Å–µ –≤–æ–ø—Ä–æ—Å—ã —Ä–∞–≤–Ω–æ—Ü–µ–Ω–Ω—ã.

> –°—Å—ã–ª–∫–∞ –Ω–∞ –∫–æ–¥: [internal/domain/entity/question.go](file:///c:/project/vmdeploy/trivia-api/internal/domain/entity/question.go) -> [CalculatePoints](file:///c:/project/vmdeploy/trivia-api/internal/domain/entity/question.go#68-77)

---

## 3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π

–ü–æ–±–µ–¥–∏—Ç–µ–ª–µ–º —Å—á–∏—Ç–∞–µ—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π:
1. –û—Ç–≤–µ—Ç–∏–ª –Ω–∞ **–í–°–ï** –≤–æ–ø—Ä–æ—Å—ã –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã.
2. –ù–∏ —Ä–∞–∑—É –Ω–µ –æ—à–∏–±—Å—è –∏ –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏–ª –≤–æ–ø—Ä–æ—Å.
3. –ò–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å `IsEliminated = false` –≤ –∫–æ–Ω—Ü–µ –∏–≥—Ä—ã.

---

## 4. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–æ–≤–æ–≥–æ —Ñ–æ–Ω–¥–∞

### –§–æ–Ω–¥
- –£ –∫–∞–∂–¥–æ–π –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã –µ—Å—Ç—å —Å–≤–æ–π –ø—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥ (`prize_fund`).
- –ï—Å–ª–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ñ–æ–Ω–¥ –Ω–µ —É–∫–∞–∑–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: **1,000,000**.

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
1. –ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã —Å–∏—Å—Ç–µ–º–∞ —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π (`WinnersCount`).
2. –ï—Å–ª–∏ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –Ω–µ—Ç (`WinnersCount == 0`), —Ñ–æ–Ω–¥ –Ω–∏–∫–æ–º—É –Ω–µ –¥–æ—Å—Ç–∞–µ—Ç—Å—è.
3. –ï—Å–ª–∏ –ø–æ–±–µ–¥–∏—Ç–µ–ª–∏ –µ—Å—Ç—å:
   $$ \text{PrizePerWinner} = \frac{\text{TotalPrizeFund}}{\text{WinnersCount}} $$
   *(–î–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ, –∫–æ–ø–µ–π–∫–∏ –æ—Ç–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è)*
4. –ö–∞–∂–¥—ã–π –ø–æ–±–µ–¥–∏—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —Ä–∞–≤–Ω—É—é –¥–æ–ª—é.

---

## 5. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- **–ú–∞–∫—Å–∏–º—É–º –∏–≥—Ä–æ–∫–æ–≤:** –õ–∏–º–∏—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º WebSocket (—Å–µ–π—á–∞—Å ~5000 –Ω–∞ —à–∞—Ä–¥, 4 —à–∞—Ä–¥–∞ = ~20,000).
- **–î—É–±–ª–∏–∫–∞—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤:** –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏—Å–ª–∞–ª –¥–≤–∞ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –æ–¥–∏–Ω –≤–æ–ø—Ä–æ—Å ‚Äî –∑–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è **–ø–µ—Ä–≤—ã–π**, –≤—Ç–æ—Ä–æ–π –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è (–æ—à–∏–±–∫–∞ `user already answered`).

‚úÖ –ü—Ä–∞–≤–∏–ª–æ ‚Ññ1. –õ–æ–≥–∏–∫–∞ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã (core quiz flow) - —Ç–æ—á–Ω–æ–µ —Å—Ö–æ–∂–¥–µ–Ω–∏–µ —Å –∫–æ–¥–æ–º.
1. –°—Ç–∞—Ä—Ç –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
–í–∏–∫—Ç–æ—Ä–∏–Ω–∞ –∏–º–µ–µ—Ç scheduled_time, –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.

–í –º–æ–º–µ–Ω—Ç —Å—Ç–∞—Ä—Ç–∞:

–ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤–∏–∫—Ç–æ—Ä–∏–Ω–∞ + –≤–æ–ø—Ä–æ—Å—ã –∏–∑ –ë–î.

–°–æ–∑–¥–∞—ë—Ç—Å—è ActiveQuizState.

–í—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è quiz:start.

2. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
–ò–≥—Ä–æ–∫ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –ø–æ WS, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç user:ready —Å quiz_id.

–°–µ—Ä–≤–µ—Ä:

–ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç –∏–≥—Ä–æ–∫–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –≤–∏–∫—Ç–æ—Ä–∏–Ω—É;

–¥–æ–±–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ Redis Set quiz:{id}:participants (–∫–ª—é—á –∏—Å—Ç–∏–Ω—ã –ø–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º).

3. –í–æ–ø—Ä–æ—Å—ã
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞:

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π –≤–æ–ø—Ä–æ—Å –≤ ActiveQuizState.

–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å start_time (–≤ –ø–∞–º—è—Ç–∏ + Redis).

–û—Ç–ø—Ä–∞–≤–∏—Ç—å quiz:question –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º.

–ü–æ–¥–æ–∂–¥–∞—Ç—å time_limit.

4. –û—Ç–≤–µ—Ç
–ü—Ä–∏ user:answer:

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –æ—Ç–≤–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —Ç–µ–∫—É—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É.

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏.

–ü–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞.

–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç –≤ –ë–î.

–û–±–Ω–æ–≤–∏—Ç—å Redis‚Äë–∫–ª—é—á –æ—Ç–≤–µ—Ç–∞ quiz:{id}:user:{id}:question:{id}.

–í—ã–±—ã–≤–∞–Ω–∏–µ:
–ò–≥—Ä–æ–∫ –≤—ã–±—ã–≤–∞–µ—Ç, –µ—Å–ª–∏:

–æ—Ç–≤–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, –∏–ª–∏

–æ—Ç–≤–µ—Ç –ø–æ—Å–ª–µ –¥–µ–¥–ª–∞–π–Ω–∞, –∏–ª–∏

–Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –≤–æ–≤—Å–µ (—Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –ø–æ—Å–ª–µ —Ç–∞–π–º‚Äë–∞—É—Ç–∞ –≤–æ–ø—Ä–æ—Å–∞).

–í—ã–±—ã–≤–∞–Ω–∏–µ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è Redis‚Äë–∫–ª—é—á–æ–º quiz:{id}:eliminated:{user}.

5. –¢–∞–π–º‚Äë–∞—É—Ç –≤–æ–ø—Ä–æ—Å–∞
–ü–æ—Å–ª–µ —Ç–∞–π–º‚Äë–∞—É—Ç–∞:

–ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏–∑ Redis Set.

–ö—Ç–æ –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª ‚Üí –≤—ã–±—ã–≤–∞–µ—Ç.

6. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã
–ü–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞:

–°—Ç–∞—Ç—É—Å –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã = completed.

–†–∞—Å—Å—ã–ª–∞–µ—Ç—Å—è quiz:finish.

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

–ü–æ–±–µ–¥–∏—Ç–µ–ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

–ü—Ä–∏–∑ –¥–µ–ª–∏—Ç—Å—è –ø–æ—Ä–æ–≤–Ω—É –º–µ–∂–¥—É –ø–æ–±–µ–¥–∏—Ç–µ–ª—è–º–∏.

7. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
–ü–æ—Å–ª–µ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏:

–†–∞—Å—Å—ã–ª–∞–µ—Ç—Å—è quiz:results_available.

