
app_1       | 2026/02/11 18:43:54 [Scheduler] Обратный отсчет викторины #38: 5 сек.
app_1       | 2026/02/11 18:43:54 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:43:54 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:54 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:54 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:54 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:54 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:43:54 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:countdown
app_1       | 2026/02/11 18:43:54 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:countdown. Buffer len: 0
app_1       | 2026/02/11 18:43:54 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:43:54 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:43:55 [Scheduler] Обратный отсчет викторины #38: 4 сек.
app_1       | 2026/02/11 18:43:55 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:43:55 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:55 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:55 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:55 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:55 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:43:55 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:countdown
app_1       | 2026/02/11 18:43:55 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:countdown. Buffer len: 0
app_1       | 2026/02/11 18:43:55 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:43:55 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:43:56 [Scheduler] Обратный отсчет викторины #38: 3 сек.
app_1       | 2026/02/11 18:43:56 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:43:56 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:56 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:56 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:56 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:43:56 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:countdown
app_1       | 2026/02/11 18:43:56 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:countdown. Buffer len: 0
app_1       | 2026/02/11 18:43:56 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:43:56 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:56 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:43:57 [Scheduler] Обратный отсчет викторины #38: 2 сек.
app_1       | 2026/02/11 18:43:57 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:43:57 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:57 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:57 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:57 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:43:57 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:57 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:countdown
app_1       | 2026/02/11 18:43:57 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:countdown. Buffer len: 0
app_1       | 2026/02/11 18:43:57 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:43:57 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:43:58 [Scheduler] Обратный отсчет викторины #38: 1 сек.
app_1       | 2026/02/11 18:43:58 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:43:58 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:58 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:58 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:43:58 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:countdown
app_1       | 2026/02/11 18:43:58 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:countdown. Buffer len: 0
app_1       | 2026/02/11 18:43:58 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:43:58 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:58 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:countdown
app_1       | 2026/02/11 18:43:58 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:43:59 [Scheduler] Обратный отсчет завершен для викторины #38, запуск викторины
app_1       | 2026/02/11 18:43:59 [Scheduler] Запуск викторины #38
app_1       | 
app_1       | 2026/02/11 18:43:59 /app/internal/repository/postgres/quiz_repo.go:35
app_1       | [1.780ms] [rows:1] SELECT * FROM "quizzes" WHERE "quizzes"."id" = 38 ORDER BY "quizzes"."id" LIMIT 1
app_1       | 
app_1       | 2026/02/11 18:43:59 /app/internal/repository/postgres/quiz_repo.go:125
app_1       | [3.290ms] [rows:1] UPDATE "quizzes" SET "status"='in_progress',"updated_at"='2026-02-11 18:43:59.004' WHERE id = 38 AND status = 'scheduled'
app_1       | 
app_1       | 2026/02/11 18:43:59 /app/internal/repository/postgres/quiz_repo.go:95
app_1       | [4.228ms] [rows:1] UPDATE "quizzes" SET "question_count"=10,"updated_at"='2026-02-11 18:43:59.008' WHERE id = 38
app_1       | 2026/02/11 18:43:59 [Scheduler] Викторина #38: QuestionCount=10 зафиксирован
app_1       | 2026/02/11 18:43:59 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:43:59 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:start
app_1       | 2026/02/11 18:43:59 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:start
app_1       | 2026/02/11 18:43:59 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:43:59 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:start
app_1       | 2026/02/11 18:43:59 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:start. Buffer len: 0
app_1       | 2026/02/11 18:43:59 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:43:59 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:start
app_1       | 2026/02/11 18:43:59 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:start
app_1       | 2026/02/11 18:43:59 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:43:59 [Scheduler] Уведомление о запуске викторины #38 отправлено
app_1       | 2026/02/11 18:43:59 [Scheduler] Сигнал о запуске викторины #38 отправлен в QuizManager
app_1       | 2026/02/11 18:43:59 [QuizManager] Обработка запуска викторины #38
app_1       | 
app_1       | 2026/02/11 18:43:59 /app/internal/repository/postgres/quiz_repo.go:73
app_1       | [1.201ms] [rows:0] SELECT * FROM "questions" WHERE "questions"."quiz_id" = 38
app_1       | 
app_1       | 2026/02/11 18:43:59 /app/internal/repository/postgres/quiz_repo.go:73
app_1       | [1.956ms] [rows:1] SELECT * FROM "quizzes" WHERE "quizzes"."id" = 38 ORDER BY "quizzes"."id" LIMIT 1
app_1       | 2026/02/11 18:43:59 [QuizManager] Quiz #38: no preset questions, using adaptive mode
app_1       | 2026/02/11 18:43:59 [QuestionManager] Начинаю адаптивный процесс отправки вопросов для викторины #38. Всего вопросов: 10
app_1       | 2026/02/11 18:43:59 [AdaptiveSelector] Quiz #38, Q1: prev_pass_rate=1.00, target_difficulty=1
app_1       | 
app_1       | 2026/02/11 18:43:59 /app/internal/repository/postgres/question_repo.go:155 record not found
app_1       | [5.342ms] [rows:0] SELECT * FROM "questions" WHERE quiz_id = 38 AND difficulty = 1 AND is_used = false ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 2026/02/11 18:43:59 [AdaptiveSelector] Found pool question ID=283 (difficulty=1)
app_1       | 2026/02/11 18:43:59 [AdaptiveSelector] Selected question ID=283, difficulty=1 for Q1
app_1       | 
app_1       | 2026/02/11 18:43:59 /app/internal/repository/postgres/question_repo.go:173
app_1       | [3.154ms] [rows:1] SELECT * FROM "questions" WHERE quiz_id IS NULL AND difficulty = 1 AND is_used = false ORDER BY RANDOM(),"questions"."id" LIMIT 1
nginx_1     | 185.229.121.163 - - [11/Feb/2026:18:43:59 +0000] "GET /quiz/38/play?_rsc=1v2n3 HTTP/2.0" 200 1219 "https://qazaquiz.duckdns.org/quiz/38/lobby" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36" "-"
app_1       | 2026/02/11 18:43:59 [WSHandler] Resync запрос от пользователя 1 для викторины 38
app_1       | 2026/02/11 18:43:59 [WSHandler] Успешно отправлен resync для пользователя 1, quiz 38
app_1       | 
app_1       | 2026/02/11 18:43:59 /app/internal/repository/postgres/result_repo.go:33
app_1       | [7.368ms] [rows:0] SELECT * FROM "user_answers" WHERE user_id = 1 AND quiz_id = 38 ORDER BY created_at
app_1       | 2026/02/11 18:43:59 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:43:59 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:43:59 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:43:59 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:43:59 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:question
app_1       | 2026/02/11 18:43:59 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:question. Buffer len: 0
app_1       | 2026/02/11 18:43:59 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:43:59 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:43:59 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:43:59 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:43:59 [QuestionManager] Событие quiz:question для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:43:59 [QuestionManager][DEBUG] Викторина #38, Вопрос #283: Ожидание завершения таймера (10s)...
app_1       | 2026/02/11 18:44:00 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:00 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:00 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:00 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:00 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:00 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:00 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:00 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:00 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:00 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:00 [QuestionManager] Таймер вопроса #283 (1 из 0): осталось 8 секунд
app_1       | 2026/02/11 18:44:01 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:01 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:01 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:01 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:01 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:01 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:01 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:01 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:01 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:01 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:01 [QuestionManager] Таймер вопроса #283 (1 из 0): осталось 7 секунд
app_1       | 2026/02/11 18:44:02 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:02 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:02 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:02 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:02 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:02 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:02 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:02 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:02 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:02 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:02 [QuestionManager] Таймер вопроса #283 (1 из 0): осталось 6 секунд
app_1       | 2026/02/11 18:44:03 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:03 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:03 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:03 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:03 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:03 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:03 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:03 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:03 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:03 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:03 [QuestionManager] Таймер вопроса #283 (1 из 0): осталось 5 секунд
app_1       | 2026/02/11 18:44:04 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:04 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:04 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:04 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:04 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:04 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:04 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:04 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:04 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:04 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:04 [QuestionManager] Таймер вопроса #283 (1 из 0): осталось 4 секунд
app_1       | 2026/02/11 18:44:05 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:05 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:05 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:05 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:05 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:05 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:05 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:05 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:05 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:05 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:05 [QuestionManager] Таймер вопроса #283 (1 из 0): осталось 3 секунд
app_1       | 2026/02/11 18:44:06 RedisPubSub: Published message to channel 'ws:metrics' (Subscribers: 1)
app_1       | 2026/02/11 18:44:06 [AnswerProcessor] Обработка ответа пользователя #1 на вопрос #283 (викторина #38), выбранный вариант: 1
app_1       | 2026/02/11 18:44:06 [AnswerProcessor] Ответ User #1 на Q #283 успешно сохранен в БД.
app_1       | 
app_1       | 2026/02/11 18:44:06 /app/internal/repository/postgres/result_repo.go:25
app_1       | [8.330ms] [rows:1] INSERT INTO "user_answers" ("user_id","quiz_id","question_id","selected_option","is_correct","response_time_ms","score","is_eliminated","elimination_reason","created_at") VALUES (1,38,283,1,true,6584,1,false,'','2026-02-11 18:44:06.112') RETURNING "id"
app_1       | 2026/02/11 18:44:06 [AnswerProcessor] Успешно обработан и отправлен результат для User #1 на Q #283 (Quiz #38). Выбыл: false
app_1       | 2026/02/11 18:44:06 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:06 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:06 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:06 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:06 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:06 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:06 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:06 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:06 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:06 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:06 [QuestionManager] Таймер вопроса #283 (1 из 0): осталось 2 секунд
app_1       | 2026/02/11 18:44:07 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:07 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:07 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:07 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:07 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:07 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:07 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:07 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:07 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:07 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:07 [QuestionManager] Таймер вопроса #283 (1 из 0): осталось 1 секунд
app_1       | 2026/02/11 18:44:08 [QuestionManager] Время на вопрос #283 (1 из 0) викторины #38 истекло
app_1       | 2026/02/11 18:44:09 [QuestionManager] Викторина #38, Вопрос #283 (1 из 10): Время истекло. Начинаем проверку не ответивших.
app_1       | 2026/02/11 18:44:09 [QuestionManager][DEBUG] Викторина #38, Вопрос #283: Получение участников из Redis Set quiz:38:participants...
app_1       | 2026/02/11 18:44:09 [QuestionManager][DEBUG] Викторина #38, Вопрос #283: SMembers вернул 1 участников
app_1       | 2026/02/11 18:44:09 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:09 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:09 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:09 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:09 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:09 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: adaptive:question_stats. Buffer len: 0
app_1       | 2026/02/11 18:44:09 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:09 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:09 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:09 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:09 [QuestionManager] Событие adaptive:question_stats для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:44:09 [QuestionManager] adaptive:question_stats отправлен для Q1: pass_rate=1.00, target=0.90
app_1       | 2026/02/11 18:44:09 [QuestionManager][DEBUG] Викторина #38, Вопрос #283: Отправка события quiz:answer_reveal...
app_1       | 2026/02/11 18:44:09 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:09 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:09 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:09 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:09 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:09 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:answer_reveal. Buffer len: 0
app_1       | 2026/02/11 18:44:09 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:09 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:09 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:09 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:09 [QuestionManager] Событие quiz:answer_reveal для викторины #38 успешно отправлено с 1 попытки
app_1       | 
app_1       | 2026/02/11 18:44:09 /app/internal/repository/postgres/quiz_ad_slot_repo.go:50 record not found
app_1       | [3.927ms] [rows:0] SELECT * FROM "quiz_ad_slots" WHERE quiz_id = 38 AND question_after = 1 AND is_active = true ORDER BY "quiz_ad_slots"."id" LIMIT 1
app_1       | 2026/02/11 18:44:09 [QuestionManager] Пауза 500ms между вопросами 1 и 2
app_1       | 2026/02/11 18:44:10 [AdaptiveSelector] Quiz #38, Q2: prev_pass_rate=1.00, target_difficulty=2
app_1       | 
app_1       | 2026/02/11 18:44:10 /app/internal/repository/postgres/question_repo.go:155 record not found
app_1       | [3.203ms] [rows:0] SELECT * FROM "questions" WHERE (quiz_id = 38 AND difficulty = 2 AND is_used = false) AND id NOT IN (283) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 2026/02/11 18:44:10 [AdaptiveSelector] Found pool question ID=343 (difficulty=2)
app_1       | 2026/02/11 18:44:10 [AdaptiveSelector] Selected question ID=343, difficulty=2 for Q2
app_1       | 
app_1       | 2026/02/11 18:44:10 /app/internal/repository/postgres/question_repo.go:173
app_1       | [2.792ms] [rows:1] SELECT * FROM "questions" WHERE (quiz_id IS NULL AND difficulty = 2 AND is_used = false) AND id NOT IN (283) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 2026/02/11 18:44:10 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:10 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:10 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:10 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:10 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:question
app_1       | 2026/02/11 18:44:10 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:question. Buffer len: 0
app_1       | 2026/02/11 18:44:10 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:10 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:10 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:10 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:10 [QuestionManager] Событие quiz:question для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:44:10 [QuestionManager][DEBUG] Викторина #38, Вопрос #343: Ожидание завершения таймера (10s)...
app_1       | 2026/02/11 18:44:11 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:11 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:11 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:11 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:11 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:11 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:11 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:11 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:11 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:11 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:11 [QuestionManager] Таймер вопроса #343 (2 из 0): осталось 8 секунд
app_1       | 2026/02/11 18:44:12 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:12 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:12 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:12 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:12 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:12 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:12 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:12 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:12 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:12 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:12 [QuestionManager] Таймер вопроса #343 (2 из 0): осталось 7 секунд
app_1       | 2026/02/11 18:44:13 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:13 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:13 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:13 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:13 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:13 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:13 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:13 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:13 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:13 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:13 [QuestionManager] Таймер вопроса #343 (2 из 0): осталось 6 секунд
app_1       | 2026/02/11 18:44:14 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:14 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:14 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:14 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:14 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:14 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:14 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:14 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:14 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:14 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:14 [QuestionManager] Таймер вопроса #343 (2 из 0): осталось 5 секунд
app_1       | 2026/02/11 18:44:15 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:15 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:15 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:15 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:15 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:15 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:15 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:15 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:15 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:15 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:15 [QuestionManager] Таймер вопроса #343 (2 из 0): осталось 4 секунд
app_1       | 2026/02/11 18:44:16 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:16 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:16 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:16 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:16 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:16 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:16 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:16 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:16 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:16 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:16 [QuestionManager] Таймер вопроса #343 (2 из 0): осталось 3 секунд
app_1       | 2026/02/11 18:44:17 [AnswerProcessor] Обработка ответа пользователя #1 на вопрос #343 (викторина #38), выбранный вариант: 2
app_1       | 2026/02/11 18:44:17 [AnswerProcessor] Пользователь #1 должен выбыть из викторины #38. Причина: incorrect_answer
app_1       | 
app_1       | 2026/02/11 18:44:17 /app/internal/repository/postgres/result_repo.go:25
app_1       | [5.370ms] [rows:1] INSERT INTO "user_answers" ("user_id","quiz_id","question_id","selected_option","is_correct","response_time_ms","score","is_eliminated","elimination_reason","created_at") VALUES (1,38,343,2,false,6654,0,true,'incorrect_answer','2026-02-11 18:44:17.402') RETURNING "id"
app_1       | 2026/02/11 18:44:17 [AnswerProcessor] Ответ User #1 на Q #343 успешно сохранен в БД.
app_1       | 2026/02/11 18:44:17 [AnswerProcessor] Успешно обработан и отправлен результат для User #1 на Q #343 (Quiz #38). Выбыл: true
app_1       | 2026/02/11 18:44:17 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:17 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:17 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:17 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:17 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:17 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:17 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:17 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:17 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:17 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:17 [QuestionManager] Таймер вопроса #343 (2 из 0): осталось 2 секунд
app_1       | 2026/02/11 18:44:18 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:18 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:18 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:18 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:18 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:18 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:18 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:18 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:18 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:18 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:18 [QuestionManager] Таймер вопроса #343 (2 из 0): осталось 1 секунд
app_1       | 2026/02/11 18:44:19 [QuestionManager] Время на вопрос #343 (2 из 0) викторины #38 истекло
app_1       | 2026/02/11 18:44:20 [QuestionManager] Викторина #38, Вопрос #343 (2 из 10): Время истекло. Начинаем проверку не ответивших.
app_1       | 2026/02/11 18:44:20 [QuestionManager][DEBUG] Викторина #38, Вопрос #343: Получение участников из Redis Set quiz:38:participants...
app_1       | 2026/02/11 18:44:20 [QuestionManager][DEBUG] Викторина #38, Вопрос #343: SMembers вернул 1 участников
app_1       | 2026/02/11 18:44:20 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:20 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:20 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:20 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:20 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:20 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:20 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: adaptive:question_stats. Buffer len: 0
app_1       | 2026/02/11 18:44:20 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:20 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:20 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:20 [QuestionManager] Событие adaptive:question_stats для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:44:20 [QuestionManager] adaptive:question_stats отправлен для Q2: pass_rate=0.00, target=0.85
app_1       | 2026/02/11 18:44:20 [QuestionManager][DEBUG] Викторина #38, Вопрос #343: Отправка события quiz:answer_reveal...
app_1       | 2026/02/11 18:44:20 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:20 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:20 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:20 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:20 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:20 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:20 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:20 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:answer_reveal. Buffer len: 0
app_1       | 2026/02/11 18:44:20 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:20 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:20 [QuestionManager] Событие quiz:answer_reveal для викторины #38 успешно отправлено с 1 попытки
app_1       | 
app_1       | 2026/02/11 18:44:20 /app/internal/repository/postgres/quiz_ad_slot_repo.go:50 record not found
app_1       | [3.084ms] [rows:0] SELECT * FROM "quiz_ad_slots" WHERE quiz_id = 38 AND question_after = 2 AND is_active = true ORDER BY "quiz_ad_slots"."id" LIMIT 1
app_1       | 2026/02/11 18:44:20 [QuestionManager] Пауза 500ms между вопросами 2 и 3
app_1       | 2026/02/11 18:44:21 [AdaptiveSelector] Quiz #38, Q3: prev_pass_rate=0.00, target_difficulty=1
app_1       | 
app_1       | 2026/02/11 18:44:21 /app/internal/repository/postgres/question_repo.go:155 record not found
app_1       | [2.605ms] [rows:0] SELECT * FROM "questions" WHERE (quiz_id = 38 AND difficulty = 1 AND is_used = false) AND id NOT IN (283,343) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 
app_1       | 2026/02/11 18:44:21 /app/internal/repository/postgres/question_repo.go:173
app_1       | [2.531ms] [rows:1] SELECT * FROM "questions" WHERE (quiz_id IS NULL AND difficulty = 1 AND is_used = false) AND id NOT IN (283,343) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 2026/02/11 18:44:21 [AdaptiveSelector] Found pool question ID=287 (difficulty=1)
app_1       | 2026/02/11 18:44:21 [AdaptiveSelector] Selected question ID=287, difficulty=1 for Q3
app_1       | 2026/02/11 18:44:21 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:21 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:21 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:21 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:21 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:21 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:21 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:question
app_1       | 2026/02/11 18:44:21 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:question. Buffer len: 0
app_1       | 2026/02/11 18:44:21 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:21 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:21 [QuestionManager] Событие quiz:question для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:44:21 [QuestionManager][DEBUG] Викторина #38, Вопрос #287: Ожидание завершения таймера (10s)...
app_1       | 2026/02/11 18:44:22 [AnswerProcessor] Обработка ответа пользователя #1 на вопрос #287 (викторина #38), выбранный вариант: 1
app_1       | 2026/02/11 18:44:22 [AnswerProcessor] Пользователь #1 уже выбыл из викторины #38 (проверено в начале)
app_1       | 2026/02/11 18:44:22 [WSHandler] Ошибка при обработке ProcessAnswer для пользователя 1, вопроса 287: user is eliminated from this quiz
app_1       | 2026/02/11 18:44:22 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:22 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:22 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:22 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:22 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:22 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:22 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:22 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:22 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:22 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:22 [QuestionManager] Таймер вопроса #287 (3 из 0): осталось 8 секунд
app_1       | 2026/02/11 18:44:23 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:23 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:23 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:23 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:23 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:23 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:23 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:23 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:23 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:23 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:23 [QuestionManager] Таймер вопроса #287 (3 из 0): осталось 7 секунд
app_1       | 2026/02/11 18:44:24 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:24 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:24 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:24 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:24 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:24 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:24 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:24 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:24 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:24 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:24 [QuestionManager] Таймер вопроса #287 (3 из 0): осталось 6 секунд
app_1       | 2026/02/11 18:44:25 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:25 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:25 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:25 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:25 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:25 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:25 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:25 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:25 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:25 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:25 [QuestionManager] Таймер вопроса #287 (3 из 0): осталось 5 секунд
app_1       | 2026/02/11 18:44:26 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:26 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:26 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:26 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:26 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:26 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:26 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:26 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:26 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:26 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:26 [QuestionManager] Таймер вопроса #287 (3 из 0): осталось 4 секунд
app_1       | 2026/02/11 18:44:27 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:27 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:27 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:27 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:27 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:27 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:27 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:27 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:27 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:27 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:27 [QuestionManager] Таймер вопроса #287 (3 из 0): осталось 3 секунд
app_1       | 2026/02/11 18:44:28 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:28 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:28 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:28 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:28 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:28 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:28 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:28 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:28 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:28 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:28 [QuestionManager] Таймер вопроса #287 (3 из 0): осталось 2 секунд
app_1       | 2026/02/11 18:44:29 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:29 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:29 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:29 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:29 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:29 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:29 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:29 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:29 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:29 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:29 [QuestionManager] Таймер вопроса #287 (3 из 0): осталось 1 секунд
app_1       | 2026/02/11 18:44:30 [QuestionManager] Время на вопрос #287 (3 из 0) викторины #38 истекло
app_1       | 2026/02/11 18:44:31 [QuestionManager] Викторина #38, Вопрос #287 (3 из 10): Время истекло. Начинаем проверку не ответивших.
app_1       | 2026/02/11 18:44:31 [QuestionManager][DEBUG] Викторина #38, Вопрос #287: Получение участников из Redis Set quiz:38:participants...
app_1       | 2026/02/11 18:44:31 [QuestionManager][DEBUG] Викторина #38, Вопрос #287: SMembers вернул 1 участников
app_1       | 2026/02/11 18:44:31 [QuestionManager][DEBUG] Викторина #38, Вопрос #287: User #1 не ответил, но УЖЕ был выбывший.
app_1       | 2026/02/11 18:44:31 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:31 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:31 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:31 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:31 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:31 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:31 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:31 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: adaptive:question_stats. Buffer len: 0
app_1       | 2026/02/11 18:44:31 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:31 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:31 [QuestionManager] Событие adaptive:question_stats для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:44:31 [QuestionManager] adaptive:question_stats отправлен для Q3: pass_rate=0.00, target=0.78
app_1       | 2026/02/11 18:44:32 [QuestionManager][DEBUG] Викторина #38, Вопрос #287: Отправка события quiz:answer_reveal...
app_1       | 2026/02/11 18:44:32 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:32 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:32 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:32 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:32 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:32 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:answer_reveal. Buffer len: 0
app_1       | 2026/02/11 18:44:32 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:32 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:32 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:32 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:32 [QuestionManager] Событие quiz:answer_reveal для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:44:32 [QuestionManager] Пауза 500ms между вопросами 3 и 4
app_1       | 
app_1       | 2026/02/11 18:44:32 /app/internal/repository/postgres/quiz_ad_slot_repo.go:50 record not found
app_1       | [3.027ms] [rows:0] SELECT * FROM "quiz_ad_slots" WHERE quiz_id = 38 AND question_after = 3 AND is_active = true ORDER BY "quiz_ad_slots"."id" LIMIT 1
app_1       | 2026/02/11 18:44:32 [AdaptiveSelector] Quiz #38, Q4: prev_pass_rate=-1.00, target_difficulty=3
app_1       | 
app_1       | 2026/02/11 18:44:32 /app/internal/repository/postgres/question_repo.go:155 record not found
app_1       | [1.902ms] [rows:0] SELECT * FROM "questions" WHERE (quiz_id = 38 AND difficulty = 3 AND is_used = false) AND id NOT IN (283,343,287) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 2026/02/11 18:44:32 [AdaptiveSelector] Found pool question ID=359 (difficulty=3)
app_1       | 2026/02/11 18:44:32 [AdaptiveSelector] Selected question ID=359, difficulty=3 for Q4
app_1       | 
app_1       | 2026/02/11 18:44:32 /app/internal/repository/postgres/question_repo.go:173
app_1       | [1.958ms] [rows:1] SELECT * FROM "questions" WHERE (quiz_id IS NULL AND difficulty = 3 AND is_used = false) AND id NOT IN (283,343,287) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 2026/02/11 18:44:33 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:33 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:33 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:33 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:33 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:question
app_1       | 2026/02/11 18:44:33 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:question. Buffer len: 0
app_1       | 2026/02/11 18:44:33 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:33 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:33 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:33 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:33 [QuestionManager] Событие quiz:question для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:44:33 [QuestionManager][DEBUG] Викторина #38, Вопрос #359: Ожидание завершения таймера (10s)...
app_1       | 2026/02/11 18:44:34 [AnswerProcessor] Обработка ответа пользователя #1 на вопрос #359 (викторина #38), выбранный вариант: 0
app_1       | 2026/02/11 18:44:34 [AnswerProcessor] Пользователь #1 уже выбыл из викторины #38 (проверено в начале)
app_1       | 2026/02/11 18:44:34 [WSHandler] Ошибка при обработке ProcessAnswer для пользователя 1, вопроса 359: user is eliminated from this quiz
app_1       | 2026/02/11 18:44:34 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:34 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:34 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:34 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:34 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:34 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:34 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:34 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:34 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:34 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:34 [QuestionManager] Таймер вопроса #359 (4 из 0): осталось 8 секунд
app_1       | 2026/02/11 18:44:35 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:35 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:35 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:35 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:35 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:35 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:35 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:35 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:35 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:35 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:35 [QuestionManager] Таймер вопроса #359 (4 из 0): осталось 7 секунд
app_1       | 2026/02/11 18:44:36 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:36 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:36 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:36 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:36 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:36 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:36 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:36 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:36 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:36 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:36 [QuestionManager] Таймер вопроса #359 (4 из 0): осталось 6 секунд
app_1       | 2026/02/11 18:44:37 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:37 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:37 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:37 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:37 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:37 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:37 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:37 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:37 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:37 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:37 [QuestionManager] Таймер вопроса #359 (4 из 0): осталось 5 секунд
app_1       | 2026/02/11 18:44:38 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:38 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:38 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:38 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:38 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:38 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:38 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:38 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:38 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:38 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:38 [QuestionManager] Таймер вопроса #359 (4 из 0): осталось 4 секунд
app_1       | 2026/02/11 18:44:39 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:39 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:39 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:39 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:39 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:39 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:39 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:39 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:39 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:39 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:39 [QuestionManager] Таймер вопроса #359 (4 из 0): осталось 3 секунд
app_1       | 2026/02/11 18:44:40 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:40 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:40 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:40 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:40 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:40 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:40 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:40 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:40 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:40 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:40 [QuestionManager] Таймер вопроса #359 (4 из 0): осталось 2 секунд
app_1       | 2026/02/11 18:44:41 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:41 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:41 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:41 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:41 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:41 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:41 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:41 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:41 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:41 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:41 [QuestionManager] Таймер вопроса #359 (4 из 0): осталось 1 секунд
app_1       | 2026/02/11 18:44:42 [QuestionManager] Время на вопрос #359 (4 из 0) викторины #38 истекло
app_1       | 2026/02/11 18:44:43 [QuestionManager] Викторина #38, Вопрос #359 (4 из 10): Время истекло. Начинаем проверку не ответивших.
app_1       | 2026/02/11 18:44:43 [QuestionManager][DEBUG] Викторина #38, Вопрос #359: Получение участников из Redis Set quiz:38:participants...
app_1       | 2026/02/11 18:44:43 [QuestionManager][DEBUG] Викторина #38, Вопрос #359: SMembers вернул 1 участников
app_1       | 2026/02/11 18:44:43 [QuestionManager][DEBUG] Викторина #38, Вопрос #359: User #1 не ответил, но УЖЕ был выбывший.
app_1       | 2026/02/11 18:44:43 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:43 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:43 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:43 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:43 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:43 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: adaptive:question_stats. Buffer len: 0
app_1       | 2026/02/11 18:44:43 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:43 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:43 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:43 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:43 [QuestionManager] Событие adaptive:question_stats для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:44:43 [QuestionManager] adaptive:question_stats отправлен для Q4: pass_rate=0.00, target=0.70
app_1       | 2026/02/11 18:44:43 [QuestionManager][DEBUG] Викторина #38, Вопрос #359: Отправка события quiz:answer_reveal...
app_1       | 2026/02/11 18:44:43 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:43 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:43 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:43 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:43 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:43 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:43 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:43 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:answer_reveal. Buffer len: 0
app_1       | 2026/02/11 18:44:43 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:43 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:43 [QuestionManager] Событие quiz:answer_reveal для викторины #38 успешно отправлено с 1 попытки
app_1       | 
app_1       | 2026/02/11 18:44:43 /app/internal/repository/postgres/quiz_ad_slot_repo.go:50 record not found
app_1       | [2.389ms] [rows:0] SELECT * FROM "quiz_ad_slots" WHERE quiz_id = 38 AND question_after = 4 AND is_active = true ORDER BY "quiz_ad_slots"."id" LIMIT 1
app_1       | 2026/02/11 18:44:43 [QuestionManager] Пауза 500ms между вопросами 4 и 5
app_1       | 2026/02/11 18:44:43 [AdaptiveSelector] Quiz #38, Q5: prev_pass_rate=-1.00, target_difficulty=3
app_1       | 
app_1       | 2026/02/11 18:44:43 /app/internal/repository/postgres/question_repo.go:155 record not found
app_1       | [2.082ms] [rows:0] SELECT * FROM "questions" WHERE (quiz_id = 38 AND difficulty = 3 AND is_used = false) AND id NOT IN (283,343,287,359) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 
app_1       | 2026/02/11 18:44:43 /app/internal/repository/postgres/question_repo.go:173
app_1       | [1.629ms] [rows:1] SELECT * FROM "questions" WHERE (quiz_id IS NULL AND difficulty = 3 AND is_used = false) AND id NOT IN (283,343,287,359) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 2026/02/11 18:44:43 [AdaptiveSelector] Found pool question ID=376 (difficulty=3)
app_1       | 2026/02/11 18:44:43 [AdaptiveSelector] Selected question ID=376, difficulty=3 for Q5
app_1       | 2026/02/11 18:44:44 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:44 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:44 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:44 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:44 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:question
app_1       | 2026/02/11 18:44:44 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:question. Buffer len: 0
app_1       | 2026/02/11 18:44:44 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:44 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:44 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:44 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:44 [QuestionManager] Событие quiz:question для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:44:44 [QuestionManager][DEBUG] Викторина #38, Вопрос #376: Ожидание завершения таймера (10s)...
app_1       | 2026/02/11 18:44:45 [AnswerProcessor] Обработка ответа пользователя #1 на вопрос #376 (викторина #38), выбранный вариант: 2
app_1       | 2026/02/11 18:44:45 [AnswerProcessor] Пользователь #1 уже выбыл из викторины #38 (проверено в начале)
app_1       | 2026/02/11 18:44:45 [WSHandler] Ошибка при обработке ProcessAnswer для пользователя 1, вопроса 376: user is eliminated from this quiz
app_1       | 2026/02/11 18:44:45 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:45 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:45 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:45 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:45 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:45 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:45 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:45 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:45 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:45 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:45 [QuestionManager] Таймер вопроса #376 (5 из 0): осталось 8 секунд
app_1       | 2026/02/11 18:44:46 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:46 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:46 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:46 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:46 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:46 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:46 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:46 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:46 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:46 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:46 [QuestionManager] Таймер вопроса #376 (5 из 0): осталось 7 секунд
app_1       | 2026/02/11 18:44:47 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:47 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:47 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:47 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:47 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:47 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:47 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:47 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:47 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:47 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:47 [QuestionManager] Таймер вопроса #376 (5 из 0): осталось 6 секунд
app_1       | 2026/02/11 18:44:48 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:48 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:48 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:48 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:48 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:48 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:48 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:48 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:48 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:48 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:48 [QuestionManager] Таймер вопроса #376 (5 из 0): осталось 5 секунд
app_1       | 2026/02/11 18:44:49 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:49 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:49 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:49 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:49 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:49 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:49 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:49 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:49 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:49 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:49 [QuestionManager] Таймер вопроса #376 (5 из 0): осталось 4 секунд
app_1       | 2026/02/11 18:44:50 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:50 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:50 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:50 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:50 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:50 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:50 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:50 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:50 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:50 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:50 [QuestionManager] Таймер вопроса #376 (5 из 0): осталось 3 секунд
app_1       | 2026/02/11 18:44:51 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:51 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:51 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:51 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:51 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:51 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:51 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:51 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:51 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:51 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:51 [QuestionManager] Таймер вопроса #376 (5 из 0): осталось 2 секунд
app_1       | 2026/02/11 18:44:52 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:52 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:52 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:52 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:52 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:52 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:52 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:52 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:52 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:52 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:52 [QuestionManager] Таймер вопроса #376 (5 из 0): осталось 1 секунд
app_1       | 2026/02/11 18:44:53 [QuestionManager] Время на вопрос #376 (5 из 0) викторины #38 истекло
app_1       | 2026/02/11 18:44:54 [QuestionManager] Викторина #38, Вопрос #376 (5 из 10): Время истекло. Начинаем проверку не ответивших.
app_1       | 2026/02/11 18:44:54 [QuestionManager][DEBUG] Викторина #38, Вопрос #376: Получение участников из Redis Set quiz:38:participants...
app_1       | 2026/02/11 18:44:54 [QuestionManager][DEBUG] Викторина #38, Вопрос #376: SMembers вернул 1 участников
app_1       | 2026/02/11 18:44:54 [QuestionManager][DEBUG] Викторина #38, Вопрос #376: User #1 не ответил, но УЖЕ был выбывший.
app_1       | 2026/02/11 18:44:54 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:54 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:54 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:54 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:54 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:54 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: adaptive:question_stats. Buffer len: 0
app_1       | 2026/02/11 18:44:54 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:54 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:54 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:44:54 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:54 [QuestionManager] Событие adaptive:question_stats для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:44:54 [QuestionManager] adaptive:question_stats отправлен для Q5: pass_rate=0.00, target=0.62
app_1       | 2026/02/11 18:44:54 [QuestionManager][DEBUG] Викторина #38, Вопрос #376: Отправка события quiz:answer_reveal...
app_1       | 2026/02/11 18:44:54 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:54 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:54 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:54 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:54 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:54 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:54 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:answer_reveal
app_1       | 2026/02/11 18:44:54 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:answer_reveal. Buffer len: 0
app_1       | 2026/02/11 18:44:54 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:54 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:54 [QuestionManager] Событие quiz:answer_reveal для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:44:54 [QuestionManager] Пауза 500ms между вопросами 5 и 6
app_1       | 
app_1       | 2026/02/11 18:44:54 /app/internal/repository/postgres/quiz_ad_slot_repo.go:50 record not found
app_1       | [2.357ms] [rows:0] SELECT * FROM "quiz_ad_slots" WHERE quiz_id = 38 AND question_after = 5 AND is_active = true ORDER BY "quiz_ad_slots"."id" LIMIT 1
app_1       | 2026/02/11 18:44:55 [AdaptiveSelector] Quiz #38, Q6: prev_pass_rate=-1.00, target_difficulty=4
app_1       | 
app_1       | 2026/02/11 18:44:55 /app/internal/repository/postgres/question_repo.go:155 record not found
app_1       | [2.756ms] [rows:0] SELECT * FROM "questions" WHERE (quiz_id = 38 AND difficulty = 4 AND is_used = false) AND id NOT IN (283,343,287,359,376) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 
app_1       | 2026/02/11 18:44:55 /app/internal/repository/postgres/question_repo.go:173
app_1       | [2.593ms] [rows:1] SELECT * FROM "questions" WHERE (quiz_id IS NULL AND difficulty = 4 AND is_used = false) AND id NOT IN (283,343,287,359,376) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 2026/02/11 18:44:55 [AdaptiveSelector] Found pool question ID=425 (difficulty=4)
app_1       | 2026/02/11 18:44:55 [AdaptiveSelector] Selected question ID=425, difficulty=4 for Q6
app_1       | 2026/02/11 18:44:55 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:55 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:55 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:55 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:55 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:question
app_1       | 2026/02/11 18:44:55 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:question. Buffer len: 0
app_1       | 2026/02/11 18:44:55 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:55 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:55 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:44:55 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:55 [QuestionManager] Событие quiz:question для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:44:55 [QuestionManager][DEBUG] Викторина #38, Вопрос #425: Ожидание завершения таймера (10s)...
app_1       | 2026/02/11 18:44:56 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:56 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:56 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:56 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:56 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:56 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:56 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:56 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:56 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:56 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:56 [QuestionManager] Таймер вопроса #425 (6 из 0): осталось 8 секунд
app_1       | 2026/02/11 18:44:57 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:57 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:57 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:57 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:57 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:57 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:57 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:57 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:57 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:57 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:57 [QuestionManager] Таймер вопроса #425 (6 из 0): осталось 7 секунд
app_1       | 2026/02/11 18:44:58 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:58 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:58 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:58 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:58 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:58 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:58 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:58 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:58 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:58 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:58 [QuestionManager] Таймер вопроса #425 (6 из 0): осталось 6 секунд
app_1       | 2026/02/11 18:44:59 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:44:59 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:59 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:59 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:44:59 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:44:59 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:44:59 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:44:59 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:59 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:44:59 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:44:59 [QuestionManager] Таймер вопроса #425 (6 из 0): осталось 5 секунд
app_1       | 2026/02/11 18:45:00 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:00 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:00 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:00 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:00 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:00 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:00 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:00 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:00 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:00 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:00 [QuestionManager] Таймер вопроса #425 (6 из 0): осталось 4 секунд
app_1       | 2026/02/11 18:45:01 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:01 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:01 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:01 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:01 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:01 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:01 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:01 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:01 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:01 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:01 [QuestionManager] Таймер вопроса #425 (6 из 0): осталось 3 секунд
app_1       | 2026/02/11 18:45:02 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:02 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:02 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:02 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:02 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:02 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:02 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:02 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:02 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:02 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:02 [QuestionManager] Таймер вопроса #425 (6 из 0): осталось 2 секунд
app_1       | 2026/02/11 18:45:03 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:03 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:03 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:03 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:03 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:03 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:03 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:03 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:03 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:03 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:03 [QuestionManager] Таймер вопроса #425 (6 из 0): осталось 1 секунд
app_1       | 2026/02/11 18:45:04 [QuestionManager] Время на вопрос #425 (6 из 0) викторины #38 истекло
app_1       | 2026/02/11 18:45:05 [QuestionManager] Викторина #38, Вопрос #425 (6 из 10): Время истекло. Начинаем проверку не ответивших.
app_1       | 2026/02/11 18:45:05 [QuestionManager][DEBUG] Викторина #38, Вопрос #425: Получение участников из Redis Set quiz:38:participants...
app_1       | 2026/02/11 18:45:05 [QuestionManager][DEBUG] Викторина #38, Вопрос #425: SMembers вернул 1 участников
app_1       | 2026/02/11 18:45:05 [QuestionManager][DEBUG] Викторина #38, Вопрос #425: User #1 не ответил, но УЖЕ был выбывший.
app_1       | 2026/02/11 18:45:05 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:05 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:05 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:05 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:05 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:05 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: adaptive:question_stats. Buffer len: 0
app_1       | 2026/02/11 18:45:05 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:05 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:05 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:05 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:05 [QuestionManager] Событие adaptive:question_stats для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:45:05 [QuestionManager] adaptive:question_stats отправлен для Q6: pass_rate=0.00, target=0.55
app_1       | 2026/02/11 18:45:05 [QuestionManager][DEBUG] Викторина #38, Вопрос #425: Отправка события quiz:answer_reveal...
app_1       | 2026/02/11 18:45:05 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:05 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:05 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:05 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:05 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:05 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:05 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:05 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:answer_reveal. Buffer len: 0
app_1       | 2026/02/11 18:45:05 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:05 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:05 [QuestionManager] Событие quiz:answer_reveal для викторины #38 успешно отправлено с 1 попытки
app_1       | 
app_1       | 2026/02/11 18:45:05 /app/internal/repository/postgres/quiz_ad_slot_repo.go:50 record not found
app_1       | [2.163ms] [rows:0] SELECT * FROM "quiz_ad_slots" WHERE quiz_id = 38 AND question_after = 6 AND is_active = true ORDER BY "quiz_ad_slots"."id" LIMIT 1
app_1       | 2026/02/11 18:45:05 [QuestionManager] Пауза 500ms между вопросами 6 и 7
app_1       | 2026/02/11 18:45:06 RedisPubSub: Published message to channel 'ws:metrics' (Subscribers: 1)
app_1       | 2026/02/11 18:45:06 [AdaptiveSelector] Quiz #38, Q7: prev_pass_rate=-1.00, target_difficulty=4
app_1       | 
app_1       | 2026/02/11 18:45:06 /app/internal/repository/postgres/question_repo.go:155 record not found
app_1       | [1.992ms] [rows:0] SELECT * FROM "questions" WHERE (quiz_id = 38 AND difficulty = 4 AND is_used = false) AND id NOT IN (283,343,287,359,376,425) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 
app_1       | 2026/02/11 18:45:06 /app/internal/repository/postgres/question_repo.go:173
app_1       | [1.640ms] [rows:1] SELECT * FROM "questions" WHERE (quiz_id IS NULL AND difficulty = 4 AND is_used = false) AND id NOT IN (283,343,287,359,376,425) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 2026/02/11 18:45:06 [AdaptiveSelector] Found pool question ID=418 (difficulty=4)
app_1       | 2026/02/11 18:45:06 [AdaptiveSelector] Selected question ID=418, difficulty=4 for Q7
app_1       | 2026/02/11 18:45:06 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:06 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:06 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:06 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:06 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:06 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:06 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:question
app_1       | 2026/02/11 18:45:06 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:question. Buffer len: 0
app_1       | 2026/02/11 18:45:06 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:06 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:06 [QuestionManager] Событие quiz:question для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:45:06 [QuestionManager][DEBUG] Викторина #38, Вопрос #418: Ожидание завершения таймера (10s)...
app_1       | 2026/02/11 18:45:07 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:07 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:07 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:07 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:07 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:07 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:07 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:07 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:07 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:07 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:07 [QuestionManager] Таймер вопроса #418 (7 из 0): осталось 8 секунд
app_1       | 2026/02/11 18:45:08 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:08 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:08 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:08 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:08 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:08 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:08 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:08 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:08 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:08 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:08 [QuestionManager] Таймер вопроса #418 (7 из 0): осталось 7 секунд
app_1       | 2026/02/11 18:45:09 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:09 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:09 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:09 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:09 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:09 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:09 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:09 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:09 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:09 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:09 [QuestionManager] Таймер вопроса #418 (7 из 0): осталось 6 секунд
app_1       | 2026/02/11 18:45:10 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:10 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:10 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:10 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:10 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:10 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:10 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:10 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:10 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:10 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:10 [QuestionManager] Таймер вопроса #418 (7 из 0): осталось 5 секунд
app_1       | 2026/02/11 18:45:11 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:11 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:11 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:11 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:11 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:11 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:11 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:11 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:11 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:11 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:11 [QuestionManager] Таймер вопроса #418 (7 из 0): осталось 4 секунд
app_1       | 2026/02/11 18:45:12 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:12 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:12 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:12 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:12 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:12 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:12 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:12 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:12 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:12 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:12 [QuestionManager] Таймер вопроса #418 (7 из 0): осталось 3 секунд
app_1       | 2026/02/11 18:45:13 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:13 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:13 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:13 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:13 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:13 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:13 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:13 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:13 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:13 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:13 [QuestionManager] Таймер вопроса #418 (7 из 0): осталось 2 секунд
app_1       | 2026/02/11 18:45:14 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:14 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:14 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:14 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:14 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:14 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:14 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:14 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:14 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:14 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:14 [QuestionManager] Таймер вопроса #418 (7 из 0): осталось 1 секунд
app_1       | 2026/02/11 18:45:15 [QuestionManager] Время на вопрос #418 (7 из 0) викторины #38 истекло
app_1       | 2026/02/11 18:45:16 [AnswerProcessor] Обработка ответа пользователя #1 на вопрос #418 (викторина #38), выбранный вариант: 1
app_1       | 2026/02/11 18:45:16 [AnswerProcessor] Пользователь #1 уже выбыл из викторины #38 (проверено в начале)
app_1       | 2026/02/11 18:45:16 [WSHandler] Ошибка при обработке ProcessAnswer для пользователя 1, вопроса 418: user is eliminated from this quiz
app_1       | 2026/02/11 18:45:16 [QuestionManager] Викторина #38, Вопрос #418 (7 из 10): Время истекло. Начинаем проверку не ответивших.
app_1       | 2026/02/11 18:45:16 [QuestionManager][DEBUG] Викторина #38, Вопрос #418: Получение участников из Redis Set quiz:38:participants...
app_1       | 2026/02/11 18:45:16 [QuestionManager][DEBUG] Викторина #38, Вопрос #418: SMembers вернул 1 участников
app_1       | 2026/02/11 18:45:16 [QuestionManager][DEBUG] Викторина #38, Вопрос #418: User #1 не ответил, но УЖЕ был выбывший.
app_1       | 2026/02/11 18:45:16 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:16 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:16 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:16 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:16 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:16 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:16 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: adaptive:question_stats. Buffer len: 0
app_1       | 2026/02/11 18:45:16 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:16 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:16 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:16 [QuestionManager] Событие adaptive:question_stats для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:45:16 [QuestionManager] adaptive:question_stats отправлен для Q7: pass_rate=0.00, target=0.48
app_1       | 2026/02/11 18:45:17 [QuestionManager][DEBUG] Викторина #38, Вопрос #418: Отправка события quiz:answer_reveal...
app_1       | 2026/02/11 18:45:17 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:17 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:17 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:17 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:17 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:17 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:answer_reveal. Buffer len: 0
app_1       | 2026/02/11 18:45:17 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:17 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:17 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:17 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:17 [QuestionManager] Событие quiz:answer_reveal для викторины #38 успешно отправлено с 1 попытки
app_1       | 
app_1       | 2026/02/11 18:45:17 /app/internal/repository/postgres/quiz_ad_slot_repo.go:50 record not found
app_1       | [2.341ms] [rows:0] SELECT * FROM "quiz_ad_slots" WHERE quiz_id = 38 AND question_after = 7 AND is_active = true ORDER BY "quiz_ad_slots"."id" LIMIT 1
app_1       | 2026/02/11 18:45:17 [QuestionManager] Пауза 500ms между вопросами 7 и 8
app_1       | 2026/02/11 18:45:17 [AdaptiveSelector] Quiz #38, Q8: prev_pass_rate=-1.00, target_difficulty=5
app_1       | 
app_1       | 2026/02/11 18:45:17 /app/internal/repository/postgres/question_repo.go:155 record not found
app_1       | [2.333ms] [rows:0] SELECT * FROM "questions" WHERE (quiz_id = 38 AND difficulty = 5 AND is_used = false) AND id NOT IN (283,343,287,359,376,425,418) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 2026/02/11 18:45:17 [AdaptiveSelector] Found pool question ID=548 (difficulty=5)
app_1       | 2026/02/11 18:45:17 [AdaptiveSelector] Selected question ID=548, difficulty=5 for Q8
app_1       | 
app_1       | 2026/02/11 18:45:17 /app/internal/repository/postgres/question_repo.go:173
app_1       | [2.211ms] [rows:1] SELECT * FROM "questions" WHERE (quiz_id IS NULL AND difficulty = 5 AND is_used = false) AND id NOT IN (283,343,287,359,376,425,418) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 2026/02/11 18:45:18 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:18 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:18 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:18 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:18 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:18 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:18 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:question
app_1       | 2026/02/11 18:45:18 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:question. Buffer len: 0
app_1       | 2026/02/11 18:45:18 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:18 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:18 [QuestionManager] Событие quiz:question для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:45:18 [QuestionManager][DEBUG] Викторина #38, Вопрос #548: Ожидание завершения таймера (10s)...
app_1       | 2026/02/11 18:45:19 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:19 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:19 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:19 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:19 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:19 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:19 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:19 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:19 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:19 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:19 [QuestionManager] Таймер вопроса #548 (8 из 0): осталось 8 секунд
app_1       | 2026/02/11 18:45:20 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:20 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:20 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:20 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:20 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:20 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:20 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:20 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:20 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:20 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:20 [QuestionManager] Таймер вопроса #548 (8 из 0): осталось 7 секунд
app_1       | 2026/02/11 18:45:21 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:21 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:21 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:21 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:21 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:21 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:21 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:21 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:21 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:21 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:21 [QuestionManager] Таймер вопроса #548 (8 из 0): осталось 6 секунд
app_1       | 2026/02/11 18:45:22 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:22 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:22 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:22 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:22 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:22 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:22 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:22 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:22 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:22 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:22 [QuestionManager] Таймер вопроса #548 (8 из 0): осталось 5 секунд
app_1       | 2026/02/11 18:45:23 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:23 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:23 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:23 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:23 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:23 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:23 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:23 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:23 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:23 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:23 [QuestionManager] Таймер вопроса #548 (8 из 0): осталось 4 секунд
app_1       | 2026/02/11 18:45:24 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:24 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:24 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:24 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:24 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:24 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:24 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:24 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:24 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:24 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:24 [QuestionManager] Таймер вопроса #548 (8 из 0): осталось 3 секунд
app_1       | 2026/02/11 18:45:25 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:25 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:25 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:25 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:25 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:25 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:25 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:25 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:25 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:25 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:25 [QuestionManager] Таймер вопроса #548 (8 из 0): осталось 2 секунд
app_1       | 2026/02/11 18:45:26 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:26 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:26 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:26 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:26 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:26 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:26 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:26 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:26 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:26 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:26 [QuestionManager] Таймер вопроса #548 (8 из 0): осталось 1 секунд
app_1       | 2026/02/11 18:45:27 [QuestionManager] Время на вопрос #548 (8 из 0) викторины #38 истекло
app_1       | 2026/02/11 18:45:28 [QuestionManager] Викторина #38, Вопрос #548 (8 из 10): Время истекло. Начинаем проверку не ответивших.
app_1       | 2026/02/11 18:45:28 [QuestionManager][DEBUG] Викторина #38, Вопрос #548: Получение участников из Redis Set quiz:38:participants...
app_1       | 2026/02/11 18:45:28 [QuestionManager][DEBUG] Викторина #38, Вопрос #548: SMembers вернул 1 участников
app_1       | 2026/02/11 18:45:28 [QuestionManager][DEBUG] Викторина #38, Вопрос #548: User #1 не ответил, но УЖЕ был выбывший.
app_1       | 2026/02/11 18:45:28 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:28 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:28 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:28 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:28 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:28 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: adaptive:question_stats. Buffer len: 0
app_1       | 2026/02/11 18:45:28 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:28 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:28 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:28 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:28 [QuestionManager] Событие adaptive:question_stats для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:45:28 [QuestionManager] adaptive:question_stats отправлен для Q8: pass_rate=0.00, target=0.42
app_1       | 2026/02/11 18:45:28 [QuestionManager][DEBUG] Викторина #38, Вопрос #548: Отправка события quiz:answer_reveal...
app_1       | 2026/02/11 18:45:28 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:28 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:28 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:28 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:28 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:28 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:answer_reveal. Buffer len: 0
app_1       | 2026/02/11 18:45:28 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:28 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:28 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:28 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:28 [QuestionManager] Событие quiz:answer_reveal для викторины #38 успешно отправлено с 1 попытки
app_1       | 
app_1       | 2026/02/11 18:45:28 /app/internal/repository/postgres/quiz_ad_slot_repo.go:50 record not found
app_1       | [3.208ms] [rows:0] SELECT * FROM "quiz_ad_slots" WHERE quiz_id = 38 AND question_after = 8 AND is_active = true ORDER BY "quiz_ad_slots"."id" LIMIT 1
app_1       | 2026/02/11 18:45:28 [QuestionManager] Пауза 500ms между вопросами 8 и 9
app_1       | 2026/02/11 18:45:28 [AdaptiveSelector] Quiz #38, Q9: prev_pass_rate=-1.00, target_difficulty=5
app_1       | 
app_1       | 2026/02/11 18:45:28 /app/internal/repository/postgres/question_repo.go:155 record not found
app_1       | [2.174ms] [rows:0] SELECT * FROM "questions" WHERE (quiz_id = 38 AND difficulty = 5 AND is_used = false) AND id NOT IN (283,343,287,359,376,425,418,548) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 2026/02/11 18:45:28 [AdaptiveSelector] Found pool question ID=543 (difficulty=5)
app_1       | 2026/02/11 18:45:28 [AdaptiveSelector] Selected question ID=543, difficulty=5 for Q9
app_1       | 
app_1       | 2026/02/11 18:45:28 /app/internal/repository/postgres/question_repo.go:173
app_1       | [2.348ms] [rows:1] SELECT * FROM "questions" WHERE (quiz_id IS NULL AND difficulty = 5 AND is_used = false) AND id NOT IN (283,343,287,359,376,425,418,548) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 2026/02/11 18:45:29 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:29 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:29 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:29 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:29 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:question
app_1       | 2026/02/11 18:45:29 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:question. Buffer len: 0
app_1       | 2026/02/11 18:45:29 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:29 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:29 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:29 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:29 [QuestionManager] Событие quiz:question для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:45:29 [QuestionManager][DEBUG] Викторина #38, Вопрос #543: Ожидание завершения таймера (10s)...
app_1       | 2026/02/11 18:45:30 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:30 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:30 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:30 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:30 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:30 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:30 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:30 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:30 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:30 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:30 [QuestionManager] Таймер вопроса #543 (9 из 0): осталось 8 секунд
app_1       | 2026/02/11 18:45:31 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:31 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:31 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:31 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:31 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:31 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:31 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:31 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:31 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:31 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:31 [QuestionManager] Таймер вопроса #543 (9 из 0): осталось 7 секунд
app_1       | 2026/02/11 18:45:32 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:32 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:32 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:32 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:32 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:32 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:32 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:32 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:32 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:32 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:32 [QuestionManager] Таймер вопроса #543 (9 из 0): осталось 6 секунд
app_1       | 2026/02/11 18:45:33 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:33 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:33 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:33 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:33 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:33 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:33 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:33 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:33 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:33 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:33 [QuestionManager] Таймер вопроса #543 (9 из 0): осталось 5 секунд
app_1       | 2026/02/11 18:45:34 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:34 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:34 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:34 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:34 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:34 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:34 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:34 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:34 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:34 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:34 [QuestionManager] Таймер вопроса #543 (9 из 0): осталось 4 секунд
app_1       | 2026/02/11 18:45:35 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:35 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:35 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:35 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:35 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:35 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:35 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:35 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:35 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:35 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:35 [QuestionManager] Таймер вопроса #543 (9 из 0): осталось 3 секунд
app_1       | 2026/02/11 18:45:36 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:36 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:36 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:36 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:36 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:36 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:36 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:36 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:36 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:36 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:36 [QuestionManager] Таймер вопроса #543 (9 из 0): осталось 2 секунд
app_1       | 2026/02/11 18:45:37 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:37 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:37 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:37 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:37 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:37 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:37 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:37 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:37 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:37 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:37 [QuestionManager] Таймер вопроса #543 (9 из 0): осталось 1 секунд
app_1       | 2026/02/11 18:45:38 [QuestionManager] Время на вопрос #543 (9 из 0) викторины #38 истекло
app_1       | 2026/02/11 18:45:39 [QuestionManager] Викторина #38, Вопрос #543 (9 из 10): Время истекло. Начинаем проверку не ответивших.
app_1       | 2026/02/11 18:45:39 [QuestionManager][DEBUG] Викторина #38, Вопрос #543: Получение участников из Redis Set quiz:38:participants...
app_1       | 2026/02/11 18:45:39 [QuestionManager][DEBUG] Викторина #38, Вопрос #543: SMembers вернул 1 участников
app_1       | 2026/02/11 18:45:39 [QuestionManager][DEBUG] Викторина #38, Вопрос #543: User #1 не ответил, но УЖЕ был выбывший.
app_1       | 2026/02/11 18:45:39 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:39 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:39 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:39 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:39 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:39 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: adaptive:question_stats. Buffer len: 0
app_1       | 2026/02/11 18:45:39 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:39 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:39 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:39 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:39 [QuestionManager] Событие adaptive:question_stats для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:45:39 [QuestionManager] adaptive:question_stats отправлен для Q9: pass_rate=0.00, target=0.36
app_1       | 2026/02/11 18:45:39 [QuestionManager][DEBUG] Викторина #38, Вопрос #543: Отправка события quiz:answer_reveal...
app_1       | 2026/02/11 18:45:39 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:39 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:39 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:39 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:39 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:39 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:39 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:answer_reveal. Buffer len: 0
app_1       | 2026/02/11 18:45:39 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:39 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:39 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:39 [QuestionManager] Событие quiz:answer_reveal для викторины #38 успешно отправлено с 1 попытки
app_1       | 
app_1       | 2026/02/11 18:45:39 /app/internal/repository/postgres/quiz_ad_slot_repo.go:50 record not found
app_1       | [3.931ms] [rows:0] SELECT * FROM "quiz_ad_slots" WHERE quiz_id = 38 AND question_after = 9 AND is_active = true ORDER BY "quiz_ad_slots"."id" LIMIT 1
app_1       | 2026/02/11 18:45:39 [QuestionManager] Пауза 500ms между вопросами 9 и 10
app_1       | 2026/02/11 18:45:39 [AdaptiveSelector] Quiz #38, Q10: prev_pass_rate=-1.00, target_difficulty=5
app_1       | 
app_1       | 2026/02/11 18:45:39 /app/internal/repository/postgres/question_repo.go:155 record not found
app_1       | [2.255ms] [rows:0] SELECT * FROM "questions" WHERE (quiz_id = 38 AND difficulty = 5 AND is_used = false) AND id NOT IN (283,343,287,359,376,425,418,548,543) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 
app_1       | 2026/02/11 18:45:39 /app/internal/repository/postgres/question_repo.go:173
app_1       | [2.216ms] [rows:1] SELECT * FROM "questions" WHERE (quiz_id IS NULL AND difficulty = 5 AND is_used = false) AND id NOT IN (283,343,287,359,376,425,418,548,543) ORDER BY RANDOM(),"questions"."id" LIMIT 1
app_1       | 2026/02/11 18:45:39 [AdaptiveSelector] Found pool question ID=511 (difficulty=5)
app_1       | 2026/02/11 18:45:39 [AdaptiveSelector] Selected question ID=511, difficulty=5 for Q10
app_1       | 2026/02/11 18:45:40 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:40 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:40 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:40 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:40 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:question
app_1       | 2026/02/11 18:45:40 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:question. Buffer len: 0
app_1       | 2026/02/11 18:45:40 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:40 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:40 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:question
app_1       | 2026/02/11 18:45:40 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:40 [QuestionManager] Событие quiz:question для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:45:40 [QuestionManager][DEBUG] Викторина #38, Вопрос #511: Ожидание завершения таймера (10s)...
app_1       | 2026/02/11 18:45:41 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:41 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:41 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:41 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:41 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:41 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:41 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:41 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:41 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:41 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:41 [QuestionManager] Таймер вопроса #511 (10 из 0): осталось 8 секунд
app_1       | 2026/02/11 18:45:42 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:42 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:42 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:42 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:42 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:42 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:42 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:42 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:42 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:42 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:42 [QuestionManager] Таймер вопроса #511 (10 из 0): осталось 7 секунд
app_1       | 2026/02/11 18:45:43 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:43 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:43 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:43 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:43 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:43 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:43 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:43 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:43 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:43 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:43 [QuestionManager] Таймер вопроса #511 (10 из 0): осталось 6 секунд
app_1       | 2026/02/11 18:45:44 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:44 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:44 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:44 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:44 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:44 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:44 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:44 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:44 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:44 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:44 [QuestionManager] Таймер вопроса #511 (10 из 0): осталось 5 секунд
app_1       | 2026/02/11 18:45:45 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:45 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:45 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:45 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:45 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:45 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:45 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:45 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:45 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:45 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:45 [QuestionManager] Таймер вопроса #511 (10 из 0): осталось 4 секунд
app_1       | 2026/02/11 18:45:46 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:46 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:46 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:46 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:46 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:46 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:46 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:46 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:46 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:46 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:46 [QuestionManager] Таймер вопроса #511 (10 из 0): осталось 3 секунд
app_1       | 2026/02/11 18:45:47 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:47 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:47 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:47 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:47 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:47 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:47 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:47 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:47 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:47 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:47 [QuestionManager] Таймер вопроса #511 (10 из 0): осталось 2 секунд
app_1       | 2026/02/11 18:45:48 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:48 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:48 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:48 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:48 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:timer
app_1       | 2026/02/11 18:45:48 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:timer. Buffer len: 0
app_1       | 2026/02/11 18:45:48 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:48 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:48 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:timer
app_1       | 2026/02/11 18:45:48 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:48 [QuestionManager] Таймер вопроса #511 (10 из 0): осталось 1 секунд
app_1       | 2026/02/11 18:45:49 [QuestionManager] Время на вопрос #511 (10 из 0) викторины #38 истекло
app_1       | 2026/02/11 18:45:50 [QuestionManager] Викторина #38, Вопрос #511 (10 из 10): Время истекло. Начинаем проверку не ответивших.
app_1       | 2026/02/11 18:45:50 [QuestionManager][DEBUG] Викторина #38, Вопрос #511: Получение участников из Redis Set quiz:38:participants...
app_1       | 2026/02/11 18:45:50 [QuestionManager][DEBUG] Викторина #38, Вопрос #511: SMembers вернул 1 участников
app_1       | 2026/02/11 18:45:50 [QuestionManager][DEBUG] Викторина #38, Вопрос #511: User #1 не ответил, но УЖЕ был выбывший.
app_1       | 2026/02/11 18:45:50 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:50 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:50 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: adaptive:question_stats. Buffer len: 0
app_1       | 2026/02/11 18:45:50 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:50 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: adaptive:question_stats
app_1       | 2026/02/11 18:45:50 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:50 [QuestionManager] Событие adaptive:question_stats для викторины #38 успешно отправлено с 1 попытки
app_1       | 2026/02/11 18:45:50 [QuestionManager] adaptive:question_stats отправлен для Q10: pass_rate=0.00, target=0.50
app_1       | 2026/02/11 18:45:50 [QuestionManager][DEBUG] Викторина #38, Вопрос #511: Отправка события quiz:answer_reveal...
app_1       | 2026/02/11 18:45:50 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:50 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:answer_reveal. Buffer len: 0
app_1       | 2026/02/11 18:45:50 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:50 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:50 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:answer_reveal
app_1       | 2026/02/11 18:45:50 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:50 [QuestionManager] Событие quiz:answer_reveal для викторины #38 успешно отправлено с 1 попытки
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/repository/postgres/quiz_ad_slot_repo.go:50 record not found
app_1       | [2.705ms] [rows:0] SELECT * FROM "quiz_ad_slots" WHERE quiz_id = 38 AND question_after = 10 AND is_active = true ORDER BY "quiz_ad_slots"."id" LIMIT 1
app_1       | 2026/02/11 18:45:50 [QuestionManager] Помечено 10 вопросов как использованные
app_1       | 2026/02/11 18:45:50 [QuestionManager] Сигнал о завершении вопросов для викторины #38 отправлен
app_1       | 2026/02/11 18:45:50 [QuizManager] Завершение викторины #38
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/repository/postgres/question_repo.go:135
app_1       | [5.669ms] [rows:10] UPDATE "questions" SET "is_used"=true,"updated_at"='2026-02-11 18:45:50.682' WHERE id IN (283,343,287,359,376,425,418,548,543,511)
app_1       | 2026/02/11 18:45:50 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:50 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:finish
app_1       | 2026/02/11 18:45:50 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:finish
app_1       | 2026/02/11 18:45:50 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:finish
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:finish
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:finish
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:finish. Buffer len: 0
app_1       | 2026/02/11 18:45:50 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:50 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:50 [QuizManager] Получение списка участников из Redis Set quiz:38:participants для викторины #38...
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/repository/postgres/quiz_repo.go:87
app_1       | [2.802ms] [rows:1] UPDATE "quizzes" SET "status"='completed',"updated_at"='2026-02-11 18:45:50.688' WHERE id = 38
app_1       | 2026/02/11 18:45:50 [QuizManager] Расчет и сохранение итоговых результатов для 1 участников викторины #38...
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/repository/postgres/user_repo.go:33
app_1       | [1.903ms] [rows:1] SELECT * FROM "users" WHERE "users"."id" = 1 ORDER BY "users"."id" LIMIT 1
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/repository/postgres/quiz_repo.go:73
app_1       | [0.537ms] [rows:0] SELECT * FROM "questions" WHERE "questions"."quiz_id" = 38
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/repository/postgres/quiz_repo.go:73
app_1       | [1.495ms] [rows:1] SELECT * FROM "quizzes" WHERE "quizzes"."id" = 38 ORDER BY "quizzes"."id" LIMIT 1
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/repository/postgres/result_repo.go:33
app_1       | [1.486ms] [rows:2] SELECT * FROM "user_answers" WHERE user_id = 1 AND quiz_id = 38 ORDER BY created_at
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/service/result_service.go:128
app_1       | [7.870ms] [rows:1] INSERT INTO "results" ("user_id","quiz_id","username","profile_picture","score","correct_answers","total_questions","rank","is_winner","prize_fund","is_eliminated","completed_at","created_at","updated_at","eliminated_on_question","elimination_reason") VALUES (1,38,'Temirlan','',1,1,10,0,false,0,true,'2026-02-11 18:45:50.696','2026-02-11 18:45:50.698','2026-02-11 18:45:50.698',2,'incorrect_answer') RETURNING "eliminated_on_question","elimination_reason","id"
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/service/result_service.go:135
app_1       | [2.720ms] [rows:1] UPDATE "users" SET "total_score"=total_score + 1,"updated_at"='2026-02-11 18:45:50.705' WHERE id = 1
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/service/result_service.go:142
app_1       | [1.919ms] [rows:0] UPDATE "users" SET "highest_score"=1,"updated_at"='2026-02-11 18:45:50.708' WHERE id = 1 AND highest_score < 1
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/service/result_service.go:148
app_1       | [1.255ms] [rows:1] UPDATE "users" SET "games_played"=games_played + 1 WHERE id = 1
app_1       | 2026/02/11 18:45:50 [ResultService] Успешно рассчитан и сохранен результат для пользователя #1 в викторине #38
app_1       | 2026/02/11 18:45:50 [QuizManager] Индивидуальные результаты для викторины #38 рассчитаны.
app_1       | 2026/02/11 18:45:50 [QuizManager] Определение победителей и распределение призов для викторины #38...
app_1       | 2026/02/11 18:45:50 [ResultService] Финализация результатов для викторины #38
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/repository/postgres/quiz_repo.go:73
app_1       | [0.672ms] [rows:0] SELECT * FROM "questions" WHERE "questions"."quiz_id" = 38
app_1       | 2026/02/11 18:45:50 [ResultService] Викторина #38: определение победителей на основе 10 вопросов
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/repository/postgres/quiz_repo.go:73
app_1       | [1.878ms] [rows:1] SELECT * FROM "quizzes" WHERE "quizzes"."id" = 38 ORDER BY "quizzes"."id" LIMIT 1
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/repository/postgres/result_repo.go:152
app_1       | [5.763ms] [rows:1] 
app_1       |   WITH RankedResults AS (
app_1       |       SELECT
app_1       |           id,
app_1       |           RANK() OVER (ORDER BY score DESC, correct_answers DESC) as calculated_rank
app_1       |       FROM results
app_1       |       WHERE quiz_id = 38
app_1       |   )
app_1       |   UPDATE results r
app_1       |   SET rank = rr.calculated_rank
app_1       |   FROM RankedResults rr
app_1       |   WHERE r.id = rr.id AND r.quiz_id = 38;
app_1       | 2026/02/11 18:45:50 [ResultRepo] Ranks successfully calculated and updated for quiz 38 within transaction
app_1       | 2026/02/11 18:45:50 [ResultService] Ранги для викторины #38 успешно рассчитаны и сохранены в транзакции.
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/repository/postgres/result_repo.go:191
app_1       | [1.825ms] [rows:0] SELECT "user_id" FROM "results" WHERE quiz_id = 38 AND correct_answers = 10 AND is_eliminated = false
app_1       | 2026/02/11 18:45:50 [ResultRepo] FindAndUpdateWinners: Quiz 38, Winners found: 0, Prize per winner: 0 (within transaction)
app_1       | 
app_1       | 2026/02/11 18:45:50 /app/internal/repository/postgres/result_repo.go:231
app_1       | [2.692ms] [rows:1] UPDATE "results" SET "is_winner"=false,"prize_fund"=0,"updated_at"='2026-02-11 18:45:50.724' WHERE quiz_id = 38
app_1       | 2026/02/11 18:45:50 [ResultService] Найдено и обновлено 0 победителей для викторины #38 в транзакции. Приз на победителя: 0.
app_1       | 2026/02/11 18:45:50 ShardedHub: Broadcasting message to Quiz 38 across all shards
app_1       | 2026/02/11 18:45:50 [Shard 3][Quiz 38] BroadcastToQuiz called. Message type: quiz:results_available
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38] BroadcastToQuiz called. Message type: quiz:results_available
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38][Range] Iterating over client: User 1, Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Attempting to queue message type: quiz:results_available
app_1       | 2026/02/11 18:45:50 [Shard 0][Quiz 38][User 1][Conn 87dfbea8-cfb1-4424-a390-b8e0d362fd15] Successfully queued message type: quiz:results_available. Buffer len: 0
app_1       | 2026/02/11 18:45:50 Shard 0: Message broadcast to 1 clients in Quiz 38
app_1       | 2026/02/11 18:45:50 [Shard 1][Quiz 38] BroadcastToQuiz called. Message type: quiz:results_available
app_1       | 2026/02/11 18:45:50 [Shard 2][Quiz 38] BroadcastToQuiz called. Message type: quiz:results_available
app_1       | 2026/02/11 18:45:50 ShardedHub: Finished broadcasting to Quiz 38
app_1       | 2026/02/11 18:45:50 [ResultService] Событие quiz:results_available для викторины #38 успешно отправлено
app_1       | 2026/02/11 18:45:50 [ResultService] Финализация результатов для викторины #38 успешно завершена.
app_1       | 2026/02/11 18:45:54 [JWT] Токен успешно проверен для пользователя ID=1, Email=temirlan@mail.ru, выдан: 2026-02-11 17:22:15 +0000 UTC
app_1       | 
app_1       | 2026/02/11 18:45:54 /app/internal/repository/postgres/jwt_key_repo.go:131
app_1       | [0.880ms] [rows:1] SELECT * FROM "jwt_keys" WHERE (is_active = true AND expires_at > '2026-02-11 18:45:54.875') OR (is_active = false AND rotated_at > '2026-02-04 18:45:54.875' AND expires_at > '2026-02-11 18:45:54.875') ORDER BY created_at DESC
app_1       | 
app_1       | 2026/02/11 18:45:54 /app/internal/repository/postgres/user_repo.go:33
app_1       | [1.057ms] [rows:1] SELECT * FROM "users" WHERE "users"."id" = 1 ORDER BY "users"."id" LIMIT 1
app_1       | [GIN] 2026/02/11 - 18:45:54 | 200 |    2.604915ms |      172.18.0.6 | GET      "/api/users/me"
nginx_1     | 185.229.121.163 - - [11/Feb/2026:18:45:54 +0000] "GET /api/users/me HTTP/2.0" 200 287 "https://qazaquiz.duckdns.org/quiz/38/play" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36" "-"
nginx_1     | 185.229.121.163 - - [11/Feb/2026:18:45:54 +0000] "GET /quiz/38/results?_rsc=1lp8h HTTP/2.0" 200 1219 "https://qazaquiz.duckdns.org/quiz/38/play" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36" "-"
app_1       | 2026/02/11 18:45:55 [JWT] Токен успешно проверен для пользователя ID=1, Email=temirlan@mail.ru, выдан: 2026-02-11 17:22:15 +0000 UTC
app_1       | 
nginx_1     | 185.229.121.163 - - [11/Feb/2026:18:45:55 +0000] "GET /api/users/me HTTP/2.0" 200 287 "https://qazaquiz.duckdns.org/quiz/38/play" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36" "-"
app_1       | 2026/02/11 18:45:55 /app/internal/repository/postgres/jwt_key_repo.go:131
app_1       | [0.574ms] [rows:1] SELECT * FROM "jwt_keys" WHERE (is_active = true AND expires_at > '2026-02-11 18:45:55.014') OR (is_active = false AND rotated_at > '2026-02-04 18:45:55.014' AND expires_at > '2026-02-11 18:45:55.014') ORDER BY created_at DESC
app_1       | 
app_1       | 2026/02/11 18:45:55 /app/internal/repository/postgres/user_repo.go:33
app_1       | [0.683ms] [rows:1] SELECT * FROM "users" WHERE "users"."id" = 1 ORDER BY "users"."id" LIMIT 1
app_1       | [GIN] 2026/02/11 - 18:45:55 | 200 |    1.772073ms |      172.18.0.6 | GET      "/api/users/me"
nginx_1     | 185.229.121.163 - - [11/Feb/2026:18:45:55 +0000] "GET /quiz/38/results?_rsc=1lp8h HTTP/2.0" 200 1218 "https://qazaquiz.duckdns.org/quiz/38/play" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36" "-"
app_1       | 2026/02/11 18:45:55 [JWT] Токен успешно проверен для пользователя ID=1, Email=temirlan@mail.ru, выдан: 2026-02-11 17:22:15 +0000 UTC
app_1       | 2026/02/11 18:45:55 [TokenManager] Successfully retrieved CSRF secret cookie '__Host-csrf-secret'
app_1       | 
app_1       | 2026/02/11 18:45:55 /app/internal/repository/postgres/jwt_key_repo.go:131
app_1       | [0.576ms] [rows:1] SELECT * FROM "jwt_keys" WHERE (is_active = true AND expires_at > '2026-02-11 18:45:55.154') OR (is_active = false AND rotated_at > '2026-02-04 18:45:55.154' AND expires_at > '2026-02-11 18:45:55.154') ORDER BY created_at DESC
app_1       | [GIN] 2026/02/11 - 18:45:55 | 200 |     896.345µs |      172.18.0.6 | GET      "/api/auth/csrf"
nginx_1     | 185.229.121.163 - - [11/Feb/2026:18:45:55 +0000] "GET /api/auth/csrf HTTP/2.0" 200 81 "https://qazaquiz.duckdns.org/quiz/38/play" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36" "-"
app_1       | 
nginx_1     | 185.229.121.163 - - [11/Feb/2026:18:45:55 +0000] "GET /api/quizzes/38 HTTP/2.0" 200 264 "https://qazaquiz.duckdns.org/quiz/38/results" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36" "-"
app_1       | 2026/02/11 18:45:55 /app/internal/repository/postgres/quiz_repo.go:35
app_1       | [0.450ms] [rows:1] SELECT * FROM "quizzes" WHERE "quizzes"."id" = 38 ORDER BY "quizzes"."id" LIMIT 1
app_1       | [GIN] 2026/02/11 - 18:45:55 | 200 |     819.608µs |      172.18.0.6 | GET      "/api/quizzes/38"
app_1       | 
app_1       | 2026/02/11 18:45:55 /app/internal/repository/postgres/result_repo.go:60
app_1       | [1.023ms] [rows:1] SELECT count(*) FROM "results" WHERE quiz_id = 38
app_1       | 
app_1       | 2026/02/11 18:45:55 /app/internal/repository/postgres/result_repo.go:72
app_1       | [1.687ms] [rows:1] SELECT * FROM "results" WHERE quiz_id = 38 ORDER BY rank ASC, score DESC LIMIT 20
app_1       | [GIN] 2026/02/11 - 18:45:55 | 200 |     3.73756ms |      172.18.0.6 | GET      "/api/quizzes/38/results?page=1&page_size=20"
nginx_1     | 185.229.121.163 - - [11/Feb/2026:18:45:55 +0000] "GET /api/quizzes/38/results?page=1&page_size=20 HTTP/2.0" 200 328 "https://qazaquiz.duckdns.org/quiz/38/results" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36" "-"
app_1       | 2026/02/11 18:45:55 [JWT] Токен успешно проверен для пользователя ID=1, Email=temirlan@mail.ru, выдан: 2026-02-11 17:22:15 +0000 UTC
app_1       | 
app_1       | 2026/02/11 18:45:55 /app/internal/repository/postgres/jwt_key_repo.go:131
app_1       | [0.575ms] [rows:1] SELECT * FROM "jwt_keys" WHERE (is_active = true AND expires_at > '2026-02-11 18:45:55.329') OR (is_active = false AND rotated_at > '2026-02-04 18:45:55.329' AND expires_at > '2026-02-11 18:45:55.329') ORDER BY created_at DESC
app_1       | 
app_1       | 2026/02/11 18:45:55 /app/internal/repository/postgres/result_repo.go:103
app_1       | [2.008ms] [rows:1] SELECT * FROM "results" WHERE user_id = 1 AND quiz_id = 38 ORDER BY "results"."id" LIMIT 1
app_1       | [GIN] 2026/02/11 - 18:45:55 | 200 |    3.081277ms |      172.18.0.6 | GET      "/api/quizzes/38/my-result"
nginx_1     | 185.229.121.163 - - [11/Feb/2026:18:45:55 +0000] "GET /api/quizzes/38/my-result HTTP/2.0" 200 281 "https://qazaquiz.duckdns.org/quiz/38/results" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36" "-"
app_1       | 2026/02/11 18:46:06 RedisPubSub: Published message to channel 'ws:metrics' (Subscribers: 1)
nginx_1     | 198.235.24.149 - - [11/Feb/2026:18:46:39 +0000] "GET / HTTP/1.1" 200 5019 "-" "Hello from Palo Alto Networks, find out more about our scans in https://docs-cortex.paloaltonetworks.com/r/1/Cortex-Xpanse/Scanning-activity" "-"
